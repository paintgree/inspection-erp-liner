{% extends "base.html" %}
{% block content %}

<div class="page-header">
  <h1>New Burst Test</h1>
  <a class="btn" href="/burst">Back</a>
</div>

<div class="card">

  <!-- Tabs -->
  <div class="tabs">
    <button type="button" class="tab-btn active" id="tab-linked">Linked to Cover Production</button>
    <button type="button" class="tab-btn" id="tab-manual">Manual / Unlinked</button>
  </div>

  <!-- Linked form -->
  <form id="form-linked" method="post" action="/burst/create" style="margin-top:14px;">
    <input type="hidden" name="mode" value="linked">
    <label>Select Cover Production Run</label>
    <select name="production_run_id" required>
      {% for run in runs %}
        <option value="{{ run.id }}">
          {{ run.run_number }} — {{ run.client_name }} — Total {{ run.total_length_m }}m
        </option>
      {% endfor %}
    </select>

    <div style="margin-top:16px;">
      <button class="btn btn-primary" type="submit">Create Burst Test</button>
    </div>
  </form>

  <!-- Manual form -->
  <form id="form-manual" method="post" action="/burst/create" style="margin-top:14px; display:none;">
    <input type="hidden" name="mode" value="manual">

    <div style="margin-top:16px;">
      <button class="btn btn-primary" type="submit">Create Burst Test</button>
    </div>
  </form>

</div>

<script>
(function(){
  const tabLinked = document.getElementById("tab-linked");
  const tabManual = document.getElementById("tab-manual");
  const formLinked = document.getElementById("form-linked");
  const formManual = document.getElementById("form-manual");

  function setActive(which){
    if(which === "linked"){
      tabLinked.classList.add("active");
      tabManual.classList.remove("active");
      formLinked.style.display = "block";
      formManual.style.display = "none";
    } else {
      tabManual.classList.add("active");
      tabLinked.classList.remove("active");
      formManual.style.display = "block";
      formLinked.style.display = "none";
    }
  }

  tabLinked.addEventListener("click", () => setActive("linked"));
  tabManual.addEventListener("click", () => setActive("manual"));
})();
</script>

{% endblock %}
